# 大理旅游线路规划平台 - 产品需求文档 (PRD)

> 版本：v1.0
> 更新日期：2026-01-27
> 状态：MVP阶段

---

## 一、项目概述

### 1.1 项目背景

随着自由行旅游的普及，游客在规划行程时面临以下痛点：
- 景点信息分散，需要在多个平台间切换查找
- 行程安排缺乏合理性，容易出现路线绕远、时间冲突
- 难以获取真实的本地游玩经验和推荐

本项目旨在打造一个智能化的旅游线路规划平台，以大理为首个试点城市，提供一站式的行程规划服务。

### 1.2 项目目标

**MVP目标**：
1. 用户可以一键生成合理的大理多日游行程
2. 行程可视化展示在地图上，包含路线和耗时
3. 用户可以分享行程到社区，形成UGC内容生态
4. 管理员可以维护POI数据和社区内容

**核心价值**：
- 对用户：节省行程规划时间，获得合理的游玩建议
- 对平台：积累POI数据和用户行程数据，为后续优化提供基础

### 1.3 项目范围

| 范围 | 说明 |
|-----|------|
| 地域范围 | MVP仅支持大理市 |
| 用户范围 | 面向C端游客用户 |
| 功能范围 | 行程生成、地图展示、社区分享、后台管理 |

---

## 二、用户角色定义

### 2.1 角色矩阵

| 角色 | 说明 | 核心诉求 |
|-----|------|---------|
| **游客** | 未登录用户 | 快速体验行程生成功能 |
| **注册用户** | 已注册登录用户 | 保存行程、参与社区互动 |
| **管理员** | 平台运营人员 | 管理POI数据、审核社区内容 |

### 2.2 权限对照表

| 功能 | 游客 | 注册用户 | 管理员 |
|-----|------|---------|--------|
| 生成行程 | ✅ | ✅ | ✅ |
| 查看地图 | ✅ | ✅ | ✅ |
| 保存行程 | ❌ | ✅ | ✅ |
| 发布帖子 | ❌ | ✅ | ✅ |
| 点赞/收藏 | ❌ | ✅ | ✅ |
| 查看社区 | ✅ | ✅ | ✅ |
| POI管理 | ❌ | ❌ | ✅ |
| 帖子管理 | ❌ | ❌ | ✅ |
| 数据统计 | ❌ | ❌ | ✅ |

---

## 三、功能模块清单

### 3.1 模块总览

```
┌─────────────────────────────────────────────────────────┐
│                    旅游线路规划平台                        │
├──────────────┬──────────────┬──────────────┬────────────┤
│   用户模块    │   行程模块    │   社区模块    │  管理模块   │
├──────────────┼──────────────┼──────────────┼────────────┤
│ • 注册       │ • 行程生成    │ • 社区广场    │ • POI管理  │
│ • 登录       │ • 地图可视化  │ • 帖子详情    │ • 帖子管理  │
│ • 个人中心   │ • 行程保存    │ • 点赞收藏    │ • 数据统计  │
│              │ • 历史行程    │ • 发布帖子    │            │
└──────────────┴──────────────┴──────────────┴────────────┘
```

### 3.2 功能详细说明

#### 3.2.1 用户模块

| 功能 | 描述 | 优先级 |
|-----|------|--------|
| 用户注册 | 邮箱+密码注册，邮箱唯一 | P0 |
| 用户登录 | 邮箱+密码登录，返回JWT | P0 |
| 获取用户信息 | 获取当前登录用户信息 | P0 |
| 退出登录 | 清除本地token | P0 |
| 个人中心 | 查看我的发布、收藏、历史行程 | P1 |

#### 3.2.2 行程模块

| 功能 | 描述 | 优先级 |
|-----|------|--------|
| 生成行程 | 输入天数、主题，生成行程 | P0 |
| 地图可视化 | 在地图上展示POI点和路线 | P0 |
| 保存行程 | 将生成的行程保存到个人账户 | P1 |
| 历史行程 | 查看已保存的行程列表 | P1 |
| 行程详情 | 查看行程的完整信息 | P0 |

#### 3.2.3 社区模块

| 功能 | 描述 | 优先级 |
|-----|------|--------|
| 社区广场 | 浏览所有公开的帖子 | P1 |
| 帖子详情 | 查看帖子内容和关联行程 | P1 |
| 发布帖子 | 将行程发布到社区 | P1 |
| 点赞 | 对帖子点赞/取消点赞 | P1 |
| 收藏 | 收藏帖子/取消收藏 | P1 |

#### 3.2.4 管理模块

| 功能 | 描述 | 优先级 |
|-----|------|--------|
| POI列表 | 查看所有POI，支持筛选 | P0 |
| 新增POI | 添加新的景点信息 | P0 |
| 编辑POI | 修改景点信息 | P0 |
| 删除/下架POI | 删除或下架景点 | P1 |
| 帖子管理 | 查看、下架、删除帖子 | P1 |
| 数据统计 | 查看用户数、帖子数等统计 | P2 |

---

## 四、核心业务流程

### 4.1 行程生成流程

```
┌──────────────────────────────────────────────────────────────┐
│                        用户操作                               │
└──────────────────────────────────────────────────────────────┘
        │
        ▼
┌───────────────┐     ┌───────────────┐     ┌───────────────┐
│  选择天数      │ ──► │  选择主题      │ ──► │  点击生成      │
│  (1-7天)      │     │  (可选)        │     │               │
└───────────────┘     └───────────────┘     └───────────────┘
                                                    │
                                                    ▼
┌──────────────────────────────────────────────────────────────┐
│                        系统处理                               │
└──────────────────────────────────────────────────────────────┘
        │
        ▼
┌───────────────┐     ┌───────────────┐     ┌───────────────┐
│  筛选候选POI   │ ──► │  分天分配      │ ──► │  日内排序      │
│               │     │               │     │               │
└───────────────┘     └───────────────┘     └───────────────┘
        │
        ▼
┌───────────────┐     ┌───────────────┐     ┌───────────────┐
│  计算路线耗时  │ ──► │  优化调整      │ ──► │  返回结果      │
│               │     │               │     │               │
└───────────────┘     └───────────────┘     └───────────────┘
                                                    │
                                                    ▼
┌──────────────────────────────────────────────────────────────┐
│                        结果展示                               │
└──────────────────────────────────────────────────────────────┘
        │
        ▼
┌───────────────┐     ┌───────────────┐     ┌───────────────┐
│  显示行程列表  │     │  地图可视化    │     │  保存/分享     │
│  (按天展示)   │     │  (打点+连线)   │     │  (可选)       │
└───────────────┘     └───────────────┘     └───────────────┘
```

### 4.2 社区发布流程

```
用户生成行程 ──► 点击"发布到社区" ──► 填写标题和简介 ──► 确认发布
                                                          │
                                                          ▼
                                              帖子出现在社区广场
```

### 4.3 用户注册登录流程

```
新用户 ──► 填写邮箱密码 ──► 注册成功 ──► 自动跳转登录页
                                              │
                                              ▼
老用户 ──────────────────────────────► 填写邮箱密码 ──► 登录成功 ──► 跳转首页
```

---

## 五、页面清单

### 5.1 用户端页面

| 页面 | 路由 | 描述 |
|-----|------|------|
| 登录页 | `/login` | 用户登录 |
| 注册页 | `/register` | 用户注册 |
| 行程生成页 | `/generate` | 输入参数生成行程（首页） |
| 行程结果页 | `/itinerary/:id` | 展示行程详情和地图 |
| 社区广场 | `/community` | 浏览所有帖子 |
| 帖子详情 | `/post/:id` | 查看帖子和关联行程 |
| 个人中心 | `/profile` | 我的发布/收藏/历史 |

### 5.2 管理端页面

| 页面 | 路由 | 描述 |
|-----|------|------|
| POI管理 | `/admin/pois` | POI的增删改查 |
| 帖子管理 | `/admin/posts` | 帖子审核和管理 |
| 数据统计 | `/admin/stats` | 平台数据概览 |

### 5.3 页面交互说明

#### 行程生成页
- 天数选择：下拉选择1-7天
- 主题选择：可选标签（古镇、自然风光、民族文化、美食等）
- 生成按钮：点击后显示loading，完成后自动跳转结果页

#### 行程结果页
- 左侧：行程列表，按天折叠展示
  - 每个POI显示：名称、简介、预计游玩时长
  - POI之间显示：交通方式、预计耗时
- 右侧：高德地图
  - 显示所有POI标记点
  - 显示路线连线
  - 点击标记显示POI信息
- 底部操作栏：
  - 登录用户显示：保存行程、发布到社区
  - 未登录显示：登录后可保存

#### 社区广场
- 卡片列表展示
- 每个卡片显示：标题、简介、天数、点赞数、收藏数、作者
- 排序切换：最新/最热
- 点击卡片跳转帖子详情

---

## 六、非功能性需求

### 6.1 性能需求

| 指标 | 要求 |
|-----|------|
| 行程生成时间 | 3天行程 ≤ 8秒 |
| 页面加载时间 | 首屏 ≤ 2秒 |
| 地图渲染时间 | ≤ 1秒 |
| API响应时间 | 普通接口 ≤ 500ms |

### 6.2 安全需求

| 项目 | 要求 |
|-----|------|
| 密码存储 | BCrypt加密，不可逆 |
| 接口认证 | JWT Token，24小时过期 |
| 敏感信息 | API Key等通过环境变量配置 |
| 权限控制 | 接口级别的RBAC权限校验 |

### 6.3 兼容性需求

| 项目 | 要求 |
|-----|------|
| 浏览器 | Chrome、Safari、Firefox最新版 |
| 移动端 | 响应式布局，支持移动端浏览 |

### 6.4 可用性需求

| 项目 | 要求 |
|-----|------|
| 系统可用性 | MVP阶段不做硬性要求 |
| 错误处理 | 友好的错误提示，不暴露技术细节 |
| 降级策略 | 外部API失败时有降级方案 |

---

## 七、数据需求

### 7.1 POI数据

MVP阶段需要准备的POI数据：
- 数量：至少50个大理热门景点
- 覆盖区域：古城区、洱海周边、苍山、双廊、喜洲等
- 数据字段：名称、经纬度、地址、标签、简介、封面图、区域、预计游玩时长

### 7.2 数据来源

- 高德地图POI搜索API（基础地理数据）
- AI智能标注（DeepSeek API生成业务数据）

详见 [07-AI智能服务集成方案.md](./07-AI智能服务集成方案.md)

---

## 八、里程碑计划

| 阶段 | 主要内容 | 交付物 |
|-----|---------|--------|
| Phase 1 | 基础框架 + 用户认证 | 可运行的前后端框架、登录注册功能 |
| Phase 2 | POI管理 + 数据导入 | POI管理后台、初始数据 |
| Phase 3 | 行程生成核心功能 | 行程生成、地图展示 |
| Phase 4 | 社区功能 | 帖子发布、点赞收藏、社区广场 |
| Phase 5 | 完善优化 | 个人中心、性能优化、Bug修复 |

---

## 九、后续规划（非MVP）

以下功能不在MVP范围内，详细规划请参考 [08-未来规划与扩展设计.md](./08-未来规划与扩展设计.md)。

### 9.1 v1.5 版本（+3个月）

| 功能 | 描述 |
|-----|------|
| 行程编辑 | 用户可手动调整生成的行程 |
| 评论功能 | 帖子评论互动 |
| 天气集成 | 结合天气推荐室内/室外景点 |
| 行程导出 | 导出PDF或日历文件 |

### 9.2 v2.0 版本（+6个月）

| 功能 | 描述 |
|-----|------|
| 本地推荐算法 | 脱离AI API，使用本地规则引擎 |
| 用户画像 | 基于行为分析用户偏好 |
| 个性化推荐 | 根据历史推荐相似行程 |
| 门票集成 | 对接OTA平台 |

### 9.3 v3.0 版本（+12个月）

| 功能 | 描述 |
|-----|------|
| 多城市支持 | 扩展到其他旅游城市 |
| 开放API | 提供API给第三方调用 |
| B端服务 | 面向旅行社的批量服务 |
| 用户关注 | 关注其他用户 |

---

## 十、扩展性设计原则

为保证后续升级的便利性，MVP阶段遵循以下原则：

### 10.1 算法可插拔

- 推荐引擎采用接口抽象设计
- MVP阶段使用AI API实现
- 后续可切换为本地规则引擎
- 通过配置开关控制，无需改动业务代码

### 10.2 数据可扩展

- 数据库表结构预留扩展字段
- 使用JSON类型存储可变结构数据
- 新增表不影响现有功能

### 10.3 配置驱动

- 核心参数通过配置文件管理
- 支持环境变量覆盖
- 运行时可调整，无需重启
